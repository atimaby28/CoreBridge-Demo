import{J as H,q as g,r as s}from"./index-BwYT7rAB.js";import{r as j,v as K,l as b,j as y,c as k}from"./jobposting-DwROo58C.js";const W=H("jobposting",()=>{const r=s([]),o=s(null),v=s([]),c=s([]),n=s(!1),l=s(null),i=s(1),h=s(10),p=s(0),f=s(1),w=s(0),d=s(20),m=s(0),C=g(()=>Math.ceil(p.value/h.value)),P=g(()=>i.value<C.value),L=g(()=>i.value>1),M=g(()=>Math.ceil(m.value/d.value));async function J(a,t){n.value=!0,l.value=null;try{a!==void 0&&(f.value=a),t!==void 0&&(i.value=t);const e=await j.getList(f.value,i.value,h.value);r.value=e.jobpostings,p.value=e.jobpostingCount}catch(e){throw l.value=e instanceof Error?e.message:"채용공고 목록을 불러오는데 실패했습니다.",e}finally{n.value=!1}}async function B(a,t=!1){n.value=!0,l.value=null;try{const e=await j.getById(a);if(t)try{await K.increaseViewCount(a),e.viewCount++}catch{}let u=!1;if(t)try{u=(await b.getLikeStatus(a)).liked}catch{}const E={...e,isLiked:u};return o.value=E,E}catch(e){throw l.value=e instanceof Error?e.message:"채용공고를 불러오는데 실패했습니다.",e}finally{n.value=!1}}async function x(){n.value=!0,l.value=null;try{const a=await y.getMyJobpostings();v.value=a.jobpostings}catch(a){throw l.value=a instanceof Error?a.message:"내 채용공고를 불러오는데 실패했습니다.",a}finally{n.value=!1}}async function z(a){n.value=!0,l.value=null;try{const t=await y.create(a);return await J(),t}catch(t){throw l.value=t instanceof Error?t.message:"채용공고 등록에 실패했습니다.",t}finally{n.value=!1}}async function I(a,t){var e;n.value=!0,l.value=null;try{const u=await y.update(a,t);return((e=o.value)==null?void 0:e.jobpostingId)===a&&(o.value={...o.value,...u}),u}catch(u){throw l.value=u instanceof Error?u.message:"채용공고 수정에 실패했습니다.",u}finally{n.value=!1}}async function T(a){var t;n.value=!0,l.value=null;try{await y.delete(a),r.value=r.value.filter(e=>e.jobpostingId!==a),v.value=v.value.filter(e=>e.jobpostingId!==a),((t=o.value)==null?void 0:t.jobpostingId)===a&&(o.value=null)}catch(e){throw l.value=e instanceof Error?e.message:"채용공고 삭제에 실패했습니다.",e}finally{n.value=!1}}async function N(a){if(o.value)try{o.value.isLiked?(await b.unlike(a),o.value.isLiked=!1,o.value.likeCount--):(await b.like(a),o.value.isLiked=!0,o.value.likeCount++)}catch(t){throw l.value=t instanceof Error?t.message:"좋아요 처리에 실패했습니다.",t}}async function S(a,t){n.value=!0,l.value=null;try{t!==void 0&&(w.value=t);const e=await k.getList(a,w.value,d.value);c.value=e.comments,m.value=e.commentCount}catch(e){throw l.value=e instanceof Error?e.message:"댓글을 불러오는데 실패했습니다.",e}finally{n.value=!1}}async function R(a){var t;n.value=!0,l.value=null;try{const e=await k.create(a);return await S(a.jobpostingId,0),((t=o.value)==null?void 0:t.jobpostingId)===a.jobpostingId&&o.value.commentCount++,e}catch(e){throw l.value=e instanceof Error?e.message:"댓글 작성에 실패했습니다.",e}finally{n.value=!1}}async function V(a,t){var e;n.value=!0,l.value=null;try{await k.delete(a),c.value=c.value.filter(u=>u.commentId!==a),((e=o.value)==null?void 0:e.jobpostingId)===t&&o.value.commentCount--,m.value--}catch(u){throw l.value=u instanceof Error?u.message:"댓글 삭제에 실패했습니다.",u}finally{n.value=!1}}function A(){l.value=null}function D(){o.value=null,c.value=[]}function F(a){i.value=a}function G(a){f.value=a,i.value=1}return{jobpostings:r,currentJobposting:o,myJobpostings:v,comments:c,loading:n,error:l,currentPage:i,pageSize:h,totalCount:p,currentBoardId:f,commentPage:w,commentPageSize:d,commentTotalCount:m,totalPages:C,hasNextPage:P,hasPrevPage:L,commentTotalPages:M,fetchJobpostings:J,fetchJobposting:B,fetchMyJobpostings:x,createJobposting:z,updateJobposting:I,deleteJobposting:T,toggleLike:N,fetchComments:S,createComment:R,deleteComment:V,clearError:A,clearCurrentJobposting:D,setPage:F,setBoardId:G}});export{W as u};
