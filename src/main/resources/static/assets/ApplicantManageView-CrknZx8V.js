import{d as xt,u as gt,E as et,o as yt,H as mt,c as r,i as b,I as V,r as u,F as g,b as t,p as I,s as _,t as a,n as y,h as w,q as st,g as S,C as ot,T as nt,j as ft,v as vt,a as bt,l}from"./index-BwYT7rAB.js";import{u as ht}from"./apply-D6qdncHI.js";import{u as _t}from"./jobposting-D1MJNH41.js";import{P as wt,a as kt}from"./apply-Dim5N4A0.js";import{_ as It}from"./ScheduleCreateModal.vue_vue_type_script_setup_true_lang-d4QHXo72.js";import"./apply-BYj9I28m.js";import"./jobposting-DwROo58C.js";import"./schedule-B-WyToMB.js";const St={class:"max-w-7xl mx-auto px-4 py-8"},Ct={class:"bg-white rounded-lg shadow overflow-hidden"},At={class:"min-w-full divide-y divide-gray-200"},Dt={class:"bg-white divide-y divide-gray-200"},Tt={key:0},Nt=["onClick"],$t={class:"px-6 py-4"},Et={class:"text-sm font-medium text-gray-900"},Mt={class:"px-6 py-4"},jt={class:"px-6 py-4 text-sm text-gray-500"},Bt={class:"px-6 py-4"},Lt=["onClick"],Pt={class:"mb-6"},Ft={class:"text-2xl font-bold text-gray-900"},Rt={class:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6"},Vt={class:"bg-white rounded-lg shadow p-4"},Jt={class:"text-2xl font-bold text-gray-900"},zt={class:"bg-white rounded-lg shadow p-4"},Wt={class:"text-2xl font-bold text-blue-600"},Ot={class:"bg-white rounded-lg shadow p-4"},Ut={class:"text-2xl font-bold text-green-600"},qt={class:"bg-white rounded-lg shadow p-4"},Gt={class:"text-2xl font-bold text-red-600"},Ht={class:"flex justify-end mb-4"},Kt={class:"inline-flex rounded-lg border border-gray-200 bg-white p-1"},Qt={key:0,class:"text-center py-12"},Xt={key:1,class:"bg-white rounded-lg shadow"},Yt={class:"min-w-full divide-y divide-gray-200"},Zt={class:"bg-white divide-y divide-gray-200"},te={key:0},ee={class:"px-6 py-4"},se={class:"flex items-center"},oe={class:"flex-shrink-0 h-10 w-10 bg-blue-100 rounded-full flex items-center justify-center"},ne={class:"text-blue-600 font-medium text-xs"},le={class:"ml-3"},re={class:"text-sm font-medium text-gray-900"},ae={class:"text-xs text-gray-400"},de={class:"px-6 py-4 text-sm text-gray-500"},ie={class:"px-6 py-4"},ue={class:"px-6 py-4"},ce={key:0,class:"text-sm text-gray-400"},pe={key:1,class:"flex items-center gap-2"},xe=["onClick"],ge={class:"dropdown-container"},ye=["onClick"],me=["onClick"],fe={key:2,class:"flex gap-4 overflow-x-auto pb-4"},ve={class:"p-3 border-b border-gray-200"},be={class:"flex items-center justify-between"},he={class:"font-medium text-gray-900"},_e={class:"bg-gray-200 text-gray-700 px-2 py-0.5 rounded-full text-xs"},we=["onDrop"],ke=["draggable","onDragstart"],Ie={class:"flex items-center justify-between mb-2"},Se={class:"font-medium text-sm"},Ce={class:"text-xs text-gray-500"},Ae={key:0,class:"mt-2 flex gap-1"},De=["onClick"],Te=["onClick"],Ne=["onClick"],$e={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Ee={class:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 p-6"},Me={class:"text-gray-600 mb-4"},je={class:"font-medium"},Be={class:"font-medium"},Le={class:"mb-4"},Pe={class:"flex justify-end gap-3"},Fe=["disabled"],Ke=xt({__name:"ApplicantManageView",setup(Re){const lt=bt(),M=ht(),J=_t(),z=gt(),{jobpostingApplies:C,loading:rt}=et(M),{myJobpostings:j}=et(J),p=u(null),k=u("list"),m=u(null),B=u({top:"0px",left:"0px",minWidth:"180px"}),L=u(!1),f=u(null),h=u(null),A=u(""),D=u(!1),T=u(!1),N=u(null),W=st(()=>j.value.find(s=>s.jobpostingId===p.value)),$=st(()=>{const s=C.value,e=s.length,c=s.filter(o=>o.currentStep==="FINAL_PASS"||o.passed).length,d=s.filter(o=>{var n;return((n=o.currentStep)==null?void 0:n.includes("FAIL"))||o.failed}).length,x=e-c-d;return{total:e,pending:x,passed:c,failed:d}}),at=[{step:"APPLIED",name:"ì§€ì›ì™„ë£Œ"},{step:"DOCUMENT_REVIEW",name:"ì„œë¥˜ê²€í† "},{step:"DOCUMENT_PASS",name:"ì„œë¥˜í•©ê²©"},{step:"CODING_TEST",name:"ì½”ë”©í…ŒìŠ¤íŠ¸"},{step:"INTERVIEW_1",name:"1ì°¨ë©´ì ‘"},{step:"INTERVIEW_2",name:"2ì°¨ë©´ì ‘"},{step:"FINAL_REVIEW",name:"ìµœì¢…ê²€í† "},{step:"FINAL_PASS",name:"ìµœì¢…í•©ê²©"}];function O(s){return C.value.filter(e=>e.currentStep===s||e.currentStep===`${s}_PASS`||e.currentStep===`${s}_FAIL`)}async function U(s){p.value=s,await P()}async function P(){p.value&&await M.fetchAppliesByJobposting(p.value)}function q(s){return s.deadline?new Date(s.deadline)>new Date:!0}function F(s){return s?new Date(s).toLocaleDateString("ko-KR",{year:"numeric",month:"short",day:"numeric"}):"-"}function G(s){return wt[s]||"bg-gray-100 text-gray-800"}function E(s){return kt[s]||s}function H(s){return s.includes("PASS")}function K(s){return s.includes("FAIL")}function Q(s){const e=String(s);return e.length<=6?e:e.slice(0,4)+"..."}function X(s,e){if(m.value===s){m.value=null;return}if(m.value=s,e){const d=e.currentTarget.getBoundingClientRect();B.value={top:`${d.bottom+4}px`,left:`${d.left}px`,minWidth:"180px"}}}function Y(s){const e=s.target;!e.closest(".dropdown-container")&&!e.closest('[class*="z-[9999]"]')&&(m.value=null)}function R(s,e){f.value=s,h.value=e,A.value="",m.value=null,L.value=!0}function Z(s){var e;N.value={applyId:s.applyId,userId:s.userId,jobpostingId:p.value,currentStep:s.currentStep,jobpostingTitle:(e=W.value)==null?void 0:e.title},T.value=!0}function dt(){T.value=!1,N.value=null,alert("ì¼ì •ì´ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤. ì§€ì›ìžì—ê²Œ ì•Œë¦¼ì´ ë°œì†¡ë©ë‹ˆë‹¤.")}function tt(){L.value=!1,f.value=null,h.value=null}async function it(){var s,e,c,d;if(!(!f.value||!h.value)){D.value=!0;try{console.log("Transitioning:",{applyId:f.value.applyId,nextStep:h.value,changedBy:(s=z.user)==null?void 0:s.userId}),await M.transitionByApplyId(f.value.applyId,{nextStep:h.value,changedBy:(e=z.user)==null?void 0:e.userId,reason:A.value||void 0}),tt(),await P()}catch(x){console.error("Transition error:",x);const o=((d=(c=x.response)==null?void 0:c.data)==null?void 0:d.message)||x.message||"ìƒíƒœ ë³€ê²½ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.";alert(`ìƒíƒœ ë³€ê²½ ì‹¤íŒ¨: ${o}`)}finally{D.value=!1}}}let v=null;function ut(s,e){v=e,s.dataTransfer&&(s.dataTransfer.effectAllowed="move")}function ct(s,e){s.preventDefault(),!(!v||v.completed)&&(v.allowedNextSteps.includes(e)?R(v,e):alert(`${v.currentStepName}ì—ì„œ ${E(e)}ìœ¼ë¡œ ì´ë™í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`),v=null)}async function pt(){await J.fetchMyJobpostings();const s=lt.query.jobpostingId;s&&(p.value=s,await P())}return yt(()=>{pt(),document.addEventListener("click",Y)}),mt(()=>{document.removeEventListener("click",Y)}),(s,e)=>{var c,d,x;return l(),r("div",St,[p.value?(l(),r(g,{key:1},[t("div",Pt,[t("button",{onClick:e[0]||(e[0]=o=>p.value=null),class:"flex items-center text-gray-600 hover:text-gray-900 mb-4"},[...e[9]||(e[9]=[t("span",{class:"mr-2"},"â†",-1),t("span",null,"ê³µê³  ëª©ë¡ìœ¼ë¡œ",-1)])]),t("h1",Ft,a((c=W.value)==null?void 0:c.title),1),e[10]||(e[10]=t("p",{class:"mt-1 text-gray-600"},"ì§€ì›ìž ìƒíƒœë¥¼ ê´€ë¦¬í•˜ì„¸ìš”.",-1))]),t("div",Rt,[t("div",Vt,[e[11]||(e[11]=t("p",{class:"text-sm text-gray-500"},"ì´ ì§€ì›ìž",-1)),t("p",Jt,a($.value.total)+"ëª…",1)]),t("div",zt,[e[12]||(e[12]=t("p",{class:"text-sm text-gray-500"},"ì§„í–‰ì¤‘",-1)),t("p",Wt,a($.value.pending)+"ëª…",1)]),t("div",Ot,[e[13]||(e[13]=t("p",{class:"text-sm text-gray-500"},"í•©ê²©",-1)),t("p",Ut,a($.value.passed)+"ëª…",1)]),t("div",qt,[e[14]||(e[14]=t("p",{class:"text-sm text-gray-500"},"ë¶ˆí•©ê²©",-1)),t("p",Gt,a($.value.failed)+"ëª…",1)])]),t("div",Ht,[t("div",Kt,[t("button",{onClick:e[1]||(e[1]=o=>k.value="list"),class:y(["px-4 py-2 text-sm font-medium rounded-md transition-colors",k.value==="list"?"bg-blue-600 text-white":"text-gray-600 hover:bg-gray-100"])}," ë¦¬ìŠ¤íŠ¸ ",2),t("button",{onClick:e[2]||(e[2]=o=>k.value="kanban"),class:y(["px-4 py-2 text-sm font-medium rounded-md transition-colors",k.value==="kanban"?"bg-blue-600 text-white":"text-gray-600 hover:bg-gray-100"])}," ì¹¸ë°˜ ",2)])]),I(rt)?(l(),r("div",Qt,[...e[15]||(e[15]=[t("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"},null,-1),t("p",{class:"mt-4 text-gray-500"},"ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...",-1)])])):k.value==="list"?(l(),r("div",Xt,[t("table",Yt,[e[18]||(e[18]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase w-48"},"ì§€ì›ìž"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase w-32"},"ì§€ì›ì¼"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase w-28"},"í˜„ìž¬ ë‹¨ê³„"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase w-48"},"ê´€ë¦¬")])],-1)),t("tbody",Zt,[I(C).length===0?(l(),r("tr",te,[...e[16]||(e[16]=[t("td",{colspan:"4",class:"px-6 py-12 text-center text-gray-500"}," ì§€ì›ìžê°€ ì—†ìŠµë‹ˆë‹¤. ",-1)])])):b("",!0),(l(!0),r(g,null,_(I(C),o=>(l(),r("tr",{key:o.applyId,class:"hover:bg-gray-50"},[t("td",ee,[t("div",se,[t("div",oe,[t("span",ne,a(Q(o.userId)),1)]),t("div",le,[t("p",re,"ì§€ì›ìž #"+a(o.applyId),1),t("p",ae,"ID: "+a(Q(o.userId)),1)])])]),t("td",de,a(F(o.appliedAt)),1),t("td",ie,[t("span",{class:y(["px-2 py-1 rounded-full text-xs font-medium whitespace-nowrap",G(o.currentStep)])},a(o.currentStepName),3)]),t("td",ue,[o.completed?(l(),r("span",ce,a(o.passed?"âœ… ìµœì¢…í•©ê²©":"âŒ ë¶ˆí•©ê²©"),1)):(l(),r("div",pe,[t("button",{onClick:w(n=>Z(o),["stop"]),class:"px-3 py-1.5 bg-green-50 text-green-700 rounded-lg text-sm font-medium hover:bg-green-100",title:"ì¼ì • ìž¡ê¸°"}," ðŸ“… ",8,xe),t("div",ge,[t("button",{onClick:w(n=>X(o.applyId,n),["stop"]),class:"px-3 py-1.5 bg-blue-50 text-blue-700 rounded-lg text-sm font-medium hover:bg-blue-100 flex items-center gap-1"},[...e[17]||(e[17]=[S(" ë‹¤ìŒ ë‹¨ê³„ ",-1),t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1)])],8,ye),(l(),V(nt,{to:"body"},[m.value===o.applyId?(l(),r("div",{key:0,class:"fixed bg-white rounded-lg shadow-xl border border-gray-200 py-1 z-[9999]",style:ot(B.value)},[(l(!0),r(g,null,_(o.allowedNextSteps,n=>(l(),r("button",{key:n,onClick:i=>R(o,n),class:y(["w-full px-4 py-2 text-left text-sm hover:bg-gray-100",H(n)?"text-green-700":K(n)?"text-red-700":"text-gray-700"])},a(E(n)),11,me))),128))],4)):b("",!0)]))])]))])]))),128))])])])):(l(),r("div",fe,[(l(),r(g,null,_(at,o=>t("div",{key:o.step,class:"flex-shrink-0 w-72 bg-gray-100 rounded-lg"},[t("div",ve,[t("div",be,[t("span",he,a(o.name),1),t("span",_e,a(O(o.step).length),1)])]),t("div",{class:"p-2 min-h-[200px] space-y-2",onDragover:e[3]||(e[3]=w(()=>{},["prevent"])),onDrop:n=>ct(n,o.step)},[(l(!0),r(g,null,_(O(o.step),n=>(l(),r("div",{key:n.applyId,draggable:!n.completed,onDragstart:i=>ut(i,n),class:y(["bg-white rounded-lg shadow p-3",n.completed?"opacity-60":"cursor-move hover:shadow-md"])},[t("div",Ie,[t("span",Se,"ì§€ì›ìž #"+a(n.userId),1),t("span",{class:y(["px-1.5 py-0.5 rounded text-xs",G(n.currentStep)])},a(n.currentStepName),3)]),t("p",Ce,a(F(n.appliedAt)),1),n.completed?b("",!0):(l(),r("div",Ae,[t("button",{onClick:w(i=>Z(n),["stop"]),class:"flex-1 px-2 py-1 bg-green-50 text-green-600 rounded text-xs hover:bg-green-100",title:"ì¼ì • ìž¡ê¸°"}," ðŸ“… ì¼ì • ",8,De),t("button",{onClick:w(i=>X(n.applyId,i),["stop"]),class:"flex-1 px-2 py-1 bg-gray-50 text-gray-600 rounded text-xs hover:bg-gray-100 flex items-center justify-center gap-1"},[...e[19]||(e[19]=[S(" ìƒíƒœ ",-1),t("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1)])],8,Te),(l(),V(nt,{to:"body"},[m.value===n.applyId?(l(),r("div",{key:0,class:"fixed bg-white rounded-lg shadow-xl border border-gray-200 py-1 z-[9999]",style:ot(B.value)},[(l(!0),r(g,null,_(n.allowedNextSteps,i=>(l(),r("button",{key:i,onClick:Ve=>R(n,i),class:y(["w-full px-3 py-1.5 text-left text-xs hover:bg-gray-100",H(i)?"text-green-700":K(i)?"text-red-700":"text-gray-700"])},a(E(i)),11,Ne))),128))],4)):b("",!0)]))]))],42,ke))),128))],40,we)])),64))]))],64)):(l(),r(g,{key:0},[e[8]||(e[8]=t("div",{class:"mb-8"},[t("h1",{class:"text-2xl font-bold text-gray-900"},"ì§€ì›ìž ê´€ë¦¬"),t("p",{class:"mt-2 text-gray-600"},"ì±„ìš©ê³µê³ ë¥¼ ì„ íƒí•˜ì—¬ ì§€ì›ìžë¥¼ ê´€ë¦¬í•˜ì„¸ìš”.")],-1)),t("div",Ct,[t("table",At,[e[7]||(e[7]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"ê³µê³  ì œëª©"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"ìƒíƒœ"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"ë§ˆê°ì¼"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"ê´€ë¦¬")])],-1)),t("tbody",Dt,[I(j).length===0?(l(),r("tr",Tt,[...e[6]||(e[6]=[t("td",{colspan:"4",class:"px-6 py-12 text-center text-gray-500"}," ë“±ë¡ëœ ì±„ìš©ê³µê³ ê°€ ì—†ìŠµë‹ˆë‹¤. ",-1)])])):b("",!0),(l(!0),r(g,null,_(I(j),o=>(l(),r("tr",{key:o.jobpostingId,class:"hover:bg-gray-50 cursor-pointer",onClick:n=>U(o.jobpostingId)},[t("td",$t,[t("p",Et,a(o.title),1)]),t("td",Mt,[t("span",{class:y(["px-2 py-1 rounded-full text-xs font-medium",q(o)?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"])},a(q(o)?"ëª¨ì§‘ì¤‘":"ë§ˆê°"),3)]),t("td",jt,a(F(o.deadline)),1),t("td",Bt,[t("button",{class:"text-blue-600 hover:text-blue-800 text-sm font-medium",onClick:w(n=>U(o.jobpostingId),["stop"])}," ì§€ì›ìž ë³´ê¸° â†’ ",8,Lt)])],8,Nt))),128))])])])],64)),L.value?(l(),r("div",$e,[t("div",Ee,[e[23]||(e[23]=t("h3",{class:"text-lg font-semibold mb-4"},"ìƒíƒœ ë³€ê²½ í™•ì¸",-1)),t("p",Me,[S(" ì§€ì›ìž #"+a((d=f.value)==null?void 0:d.userId)+"ì˜ ìƒíƒœë¥¼ ",1),t("span",je,a((x=f.value)==null?void 0:x.currentStepName),1),e[20]||(e[20]=S("ì—ì„œ ",-1)),t("span",Be,a(E(h.value)),1),e[21]||(e[21]=S("ìœ¼ë¡œ ë³€ê²½í•˜ì‹œê² ìŠµë‹ˆê¹Œ? ",-1))]),t("div",Le,[e[22]||(e[22]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"ì‚¬ìœ  (ì„ íƒ)",-1)),ft(t("textarea",{"onUpdate:modelValue":e[4]||(e[4]=o=>A.value=o),rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"ìƒíƒœ ë³€ê²½ ì‚¬ìœ ë¥¼ ìž…ë ¥í•˜ì„¸ìš”"},null,512),[[vt,A.value]])]),t("div",Pe,[t("button",{onClick:tt,class:"px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg"}," ì·¨ì†Œ "),t("button",{onClick:it,disabled:D.value,class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50"},a(D.value?"ì²˜ë¦¬ ì¤‘...":"í™•ì¸"),9,Fe)])])])):b("",!0),T.value&&N.value?(l(),V(It,{key:3,applicant:N.value,onClose:e[5]||(e[5]=o=>T.value=!1),onCreated:dt},null,8,["applicant"])):b("",!0)])}}});export{Ke as default};
