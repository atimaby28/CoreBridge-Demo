import{J as z,q as v,r as o}from"./index-BwYT7rAB.js";import{c as D,b as F,d as G,e as K,f as L,h as O,t as Q,i as R,j as T,k as V,l as W,a as X}from"./apply-BYj9I28m.js";const _=z("apply",()=>{const p=o([]),n=o(null),c=o([]),f=o([]),h=o([]),y=o(null),d=o(null),r=o(!1),u=o(null),m=v(()=>p.value.length),A=v(()=>p.value.filter(a=>!a.completed)),S=v(()=>p.value.filter(a=>a.completed)),g=v(()=>p.value.filter(a=>a.passed)),w=v(()=>p.value.filter(a=>a.failed));async function N(a){var s,l;r.value=!0,u.value=null;try{const e=await D(a);return p.value.unshift(e),e}catch(e){throw u.value=((l=(s=e.response)==null?void 0:s.data)==null?void 0:l.message)||"지원에 실패했습니다.",e}finally{r.value=!1}}async function B(a,s){var l,e;r.value=!0,u.value=null;try{await F(a,s),p.value=p.value.filter(t=>t.applyId!==a)}catch(t){throw u.value=((e=(l=t.response)==null?void 0:l.data)==null?void 0:e.message)||"지원 취소에 실패했습니다.",t}finally{r.value=!1}}async function P(a){var s,l;r.value=!0,u.value=null;try{n.value=await G(a)}catch(e){throw u.value=((l=(s=e.response)==null?void 0:s.data)==null?void 0:l.message)||"지원 정보를 불러오는데 실패했습니다.",e}finally{r.value=!1}}async function x(a){var s,l;r.value=!0,u.value=null;try{const e=await K(a);p.value=e.applies}catch(e){throw u.value=((l=(s=e.response)==null?void 0:s.data)==null?void 0:l.message)||"지원 목록을 불러오는데 실패했습니다.",e}finally{r.value=!1}}async function $(a){var s,l;r.value=!0,u.value=null;try{const e=await L(a);c.value=e.applies}catch(e){throw u.value=((l=(s=e.response)==null?void 0:s.data)==null?void 0:l.message)||"지원자 목록을 불러오는데 실패했습니다.",e}finally{r.value=!1}}async function b(a,s){var l,e;r.value=!0,u.value=null;try{const t=await O(a,s);c.value=t.applies}catch(t){throw u.value=((e=(l=t.response)==null?void 0:l.data)==null?void 0:e.message)||"지원자 목록을 불러오는데 실패했습니다.",t}finally{r.value=!1}}async function C(a,s){var l,e;r.value=!0,u.value=null;try{const t=await Q(a,s);return n.value&&n.value.processId===a&&(n.value.currentStep=t.currentStep,n.value.currentStepName=t.currentStepName,n.value.previousStep=t.previousStep,n.value.previousStepName=t.previousStepName,n.value.allowedNextSteps=t.allowedNextSteps,n.value.completed=t.completed,n.value.passed=t.passed,n.value.failed=t.failed),t}catch(t){throw u.value=((e=(l=t.response)==null?void 0:l.data)==null?void 0:e.message)||"상태 전이에 실패했습니다.",t}finally{r.value=!1}}async function I(a,s){var l,e;r.value=!0,u.value=null;try{const t=await R(a,s),i=c.value.findIndex(E=>E.applyId===a);return i!==-1&&(c.value[i].currentStep=t.currentStep,c.value[i].currentStepName=t.currentStepName,c.value[i].completed=t.completed,c.value[i].passed=t.passed,c.value[i].failed=t.failed),t}catch(t){throw u.value=((e=(l=t.response)==null?void 0:l.data)==null?void 0:e.message)||"상태 전이에 실패했습니다.",t}finally{r.value=!1}}async function H(a){var s,l;r.value=!0,u.value=null;try{f.value=await T(a)}catch(e){throw u.value=((l=(s=e.response)==null?void 0:s.data)==null?void 0:l.message)||"이력을 불러오는데 실패했습니다.",e}finally{r.value=!1}}async function J(){try{h.value=await V()}catch(a){console.error("단계 정보 조회 실패:",a)}}async function j(a){var s,l;r.value=!0,u.value=null;try{y.value=await W(a)}catch(e){throw u.value=((l=(s=e.response)==null?void 0:s.data)==null?void 0:l.message)||"통계를 불러오는데 실패했습니다.",e}finally{r.value=!1}}async function M(a){var s,l;r.value=!0,u.value=null;try{d.value=await X(a)}catch(e){throw u.value=((l=(s=e.response)==null?void 0:s.data)==null?void 0:l.message)||"통계를 불러오는데 실패했습니다.",e}finally{r.value=!1}}function U(){u.value=null}function k(){n.value=null}function q(){p.value=[],n.value=null,c.value=[],f.value=[],y.value=null,d.value=null,r.value=!1,u.value=null}return{myApplies:p,currentApply:n,jobpostingApplies:c,processHistory:f,allSteps:h,userStats:y,companyStats:d,loading:r,error:u,myAppliesCount:m,pendingApplies:A,completedApplies:S,passedApplies:g,failedApplies:w,createApply:N,cancelApply:B,fetchApply:P,fetchMyApplies:x,fetchAppliesByJobposting:$,fetchAppliesByStep:b,transitionProcess:C,transitionByApplyId:I,fetchProcessHistory:H,fetchAllSteps:J,fetchUserStats:j,fetchCompanyStats:M,clearError:U,clearCurrentApply:k,$reset:q}});export{_ as u};
