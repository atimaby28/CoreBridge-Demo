import{J as _,q as h,r as p,d as U,G as j,c as f,b as a,h as H,i as A,t as y,j as c,v,B as M,F,s as B,p as P,l as g}from"./index-BwYT7rAB.js";import{g as G,a as q,b as $,c as Y,d as z,e as J,u as K,f as Q,h as X,i as Z}from"./schedule-B-WyToMB.js";const ee=_("schedule",()=>{const u=p([]),E=p([]),i=p(null),n=p(!1),d=p(null),t=p(0),m=p(0),b=h(()=>u.value.filter(r=>r.status==="SCHEDULED")),I=h(()=>u.value.filter(r=>r.status==="COMPLETED"||r.status==="CANCELLED"));async function D(){try{n.value=!0,d.value=null;const r=await G();u.value=r.schedules,t.value=r.upcomingCount,m.value=r.completedCount}catch(r){console.error("ÎÇ¥ ÏùºÏ†ï Ï°∞Ìöå Ïã§Ìå®:",r),d.value=r.message||"ÏùºÏ†ïÏùÑ Î∂àÎü¨Ïò§ÎäîÎç∞ Ïã§Ìå®ÌñàÏäµÎãàÎã§."}finally{n.value=!1}}async function x(){try{n.value=!0,d.value=null;const r=await q();u.value=r.schedules,t.value=r.upcomingCount,m.value=r.completedCount}catch(r){console.error("Í∏∞ÏóÖ ÏùºÏ†ï Ï°∞Ìöå Ïã§Ìå®:",r),d.value=r.message||"ÏùºÏ†ïÏùÑ Î∂àÎü¨Ïò§ÎäîÎç∞ Ïã§Ìå®ÌñàÏäµÎãàÎã§."}finally{n.value=!1}}async function R(r,l){try{n.value=!0,E.value=await $(r,l)}catch(e){console.error("Ï∫òÎ¶∞Îçî Ïù¥Î≤§Ìä∏ Ï°∞Ìöå Ïã§Ìå®:",e),d.value=e.message}finally{n.value=!1}}async function O(r,l){try{n.value=!0,E.value=await Y(r,l)}catch(e){console.error("Ï∫òÎ¶∞Îçî Ïù¥Î≤§Ìä∏ Ï°∞Ìöå Ïã§Ìå®:",e),d.value=e.message}finally{n.value=!1}}async function S(r){try{n.value=!0,i.value=await z(r)}catch(l){console.error("ÏùºÏ†ï ÏÉÅÏÑ∏ Ï°∞Ìöå Ïã§Ìå®:",l),d.value=l.message}finally{n.value=!1}}async function T(r){try{n.value=!0;const l=await J(r);return u.value.unshift(l),t.value++,l}catch(l){throw console.error("ÏùºÏ†ï ÏÉùÏÑ± Ïã§Ìå®:",l),d.value=l.message,l}finally{n.value=!1}}async function V(r,l){var e;try{n.value=!0;const o=await K(r,l),s=u.value.findIndex(L=>L.id===r);return s!==-1&&(u.value[s]=o),((e=i.value)==null?void 0:e.id)===r&&(i.value=o),o}catch(o){throw console.error("ÏùºÏ†ï ÏàòÏ†ï Ïã§Ìå®:",o),d.value=o.message,o}finally{n.value=!1}}async function w(r,l){var e;try{n.value=!0;const o=await Q(r,{status:l}),s=u.value.findIndex(L=>L.id===r);return s!==-1&&(u.value[s]=o),((e=i.value)==null?void 0:e.id)===r&&(i.value=o),o}catch(o){throw console.error("ÏùºÏ†ï ÏÉÅÌÉú Î≥ÄÍ≤Ω Ïã§Ìå®:",o),d.value=o.message,o}finally{n.value=!1}}async function k(r){var l;try{n.value=!0,await X(r),u.value=u.value.filter(e=>e.id!==r),((l=i.value)==null?void 0:l.id)===r&&(i.value=null)}catch(e){throw console.error("ÏùºÏ†ï ÏÇ≠Ï†ú Ïã§Ìå®:",e),d.value=e.message,e}finally{n.value=!1}}async function C(r){try{return await Z(r)}catch(l){throw console.error("Ï∂©Îèå Ï≤¥ÌÅ¨ Ïã§Ìå®:",l),l}}function N(){i.value=null}return{schedules:u,calendarEvents:E,selectedSchedule:i,loading:n,error:d,upcomingCount:t,completedCount:m,upcomingSchedules:b,pastSchedules:I,fetchMySchedules:D,fetchCompanySchedules:x,fetchMyCalendarEvents:R,fetchCompanyCalendarEvents:O,fetchSchedule:S,createSchedule:T,updateSchedule:V,updateStatus:w,deleteSchedule:k,checkConflict:C,clearSelectedSchedule:N}}),W={CODING_TEST:"ÏΩîÎî© ÌÖåÏä§Ìä∏",INTERVIEW_1:"1Ï∞® Î©¥Ï†ë",INTERVIEW_2:"2Ï∞® Î©¥Ï†ë",FINAL_INTERVIEW:"ÏµúÏ¢Ö Î©¥Ï†ë",ORIENTATION:"Ïò§Î¶¨ÏóîÌÖåÏù¥ÏÖò",OTHER:"Í∏∞ÌÉÄ"},be={SCHEDULED:"ÏòàÏ†ï",IN_PROGRESS:"ÏßÑÌñâ Ï§ë",COMPLETED:"ÏôÑÎ£å",CANCELLED:"Ï∑®ÏÜå",NO_SHOW:"Î∂àÏ∞∏"},Ie={CODING_TEST:"#8B5CF6",INTERVIEW_1:"#3B82F6",INTERVIEW_2:"#10B981",FINAL_INTERVIEW:"#F59E0B",ORIENTATION:"#EC4899",OTHER:"#6B7280"},Ee={CODING_TEST:"üíª",INTERVIEW_1:"üëî",INTERVIEW_2:"üéØ",FINAL_INTERVIEW:"‚≠ê",ORIENTATION:"üìã",OTHER:"üìÖ"},te={class:"fixed inset-0 z-50 flex items-center justify-center"},le={class:"relative bg-white rounded-xl shadow-xl w-full max-w-lg mx-4 max-h-[90vh] overflow-y-auto"},ae={class:"p-6 border-b"},re={class:"flex items-center justify-between"},se={key:0,class:"bg-red-50 text-red-600 p-3 rounded-lg text-sm"},ne={key:1,class:"bg-yellow-50 text-yellow-700 p-3 rounded-lg text-sm"},oe={key:2,class:"bg-blue-50 p-4 rounded-lg"},ue={class:"text-sm text-blue-600"},ie={key:0,class:"text-sm text-blue-600"},de={key:3,class:"grid grid-cols-3 gap-3"},ce=["value"],pe={class:"grid grid-cols-2 gap-3"},ve={class:"grid grid-cols-2 gap-3"},me={class:"flex justify-end gap-3 pt-4"},fe=["disabled"],Te=U({__name:"ScheduleCreateModal",props:{applicant:{}},emits:["close","created"],setup(u,{emit:E}){var C,N,r;const i=u,n=E,d=ee(),t=p({applyId:((C=i.applicant)==null?void 0:C.applyId)||0,jobpostingId:((N=i.applicant)==null?void 0:N.jobpostingId)||0,userId:((r=i.applicant)==null?void 0:r.userId)||0,type:"INTERVIEW_1",title:"",description:"",location:"",startTime:"",endTime:"",interviewerId:void 0,interviewerName:""}),m=p(!1),b=p(null),I=p(null),D=["CODING_TEST","INTERVIEW_1","INTERVIEW_2","FINAL_INTERVIEW","ORIENTATION","OTHER"],x=h(()=>t.value.applyId>0&&t.value.jobpostingId>0&&t.value.userId>0&&t.value.title.trim()!==""&&t.value.startTime!==""&&t.value.endTime!==""&&new Date(t.value.endTime)>new Date(t.value.startTime)),R=h(()=>!!i.applicant);function O(l){return l&&{DOCUMENT_PASS:"CODING_TEST",CODING_TEST_PASS:"INTERVIEW_1",INTERVIEW_1_PASS:"INTERVIEW_2",INTERVIEW_2_PASS:"FINAL_INTERVIEW",FINAL_PASS:"ORIENTATION"}[l]||"INTERVIEW_1"}function S(){const l=W[t.value.type];t.value.title=l}async function T(){if(!(!t.value.userId||!t.value.startTime||!t.value.endTime))try{const l=await d.checkConflict({userId:t.value.userId,interviewerId:t.value.interviewerId,startTime:t.value.startTime,endTime:t.value.endTime});l.hasConflict?I.value=l.conflicts.map(e=>e.message).join(`
`):I.value=null}catch(l){console.error("Ï∂©Îèå Ï≤¥ÌÅ¨ Ïã§Ìå®:",l)}}async function V(){if(x.value)try{m.value=!0,b.value=null,await d.createSchedule({...t.value,interviewerId:t.value.interviewerId||void 0}),n("created")}catch(l){b.value=l.message||"ÏùºÏ†ï ÏÉùÏÑ±Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§."}finally{m.value=!1}}function w(){T()}function k(){const l=new Date;l.setDate(l.getDate()+1),l.setHours(10,0,0,0);const e=new Date(l);e.setHours(11,0,0,0),t.value.startTime=l.toISOString().slice(0,16),t.value.endTime=e.toISOString().slice(0,16)}return j(()=>i.applicant,l=>{l&&(t.value.applyId=l.applyId,t.value.jobpostingId=l.jobpostingId,t.value.userId=l.userId,t.value.type=O(l.currentStep),S(),k())},{immediate:!0}),(l,e)=>{var o;return g(),f("div",te,[a("div",{class:"absolute inset-0 bg-black/50",onClick:e[0]||(e[0]=s=>n("close"))}),a("div",le,[a("div",ae,[a("div",re,[e[14]||(e[14]=a("h2",{class:"text-xl font-bold text-gray-900"},"üìÖ ÏùºÏ†ï Îì±Î°ù",-1)),a("button",{onClick:e[1]||(e[1]=s=>n("close")),class:"p-2 hover:bg-gray-100 rounded-lg text-gray-400 hover:text-gray-600"}," ‚úï ")])]),a("form",{onSubmit:H(V,["prevent"]),class:"p-6 space-y-4"},[b.value?(g(),f("div",se,y(b.value),1)):A("",!0),I.value?(g(),f("div",ne," ‚ö†Ô∏è "+y(I.value),1)):A("",!0),R.value?(g(),f("div",oe,[e[15]||(e[15]=a("p",{class:"text-sm font-medium text-blue-800 mb-1"},"ÏßÄÏõêÏûê Ï†ïÎ≥¥",-1)),a("p",ue," ÏßÄÏõêÎ≤àÌò∏: #"+y(t.value.applyId)+" ¬∑ ÏßÄÏõêÏûê ID: "+y(t.value.userId),1),(o=u.applicant)!=null&&o.jobpostingTitle?(g(),f("p",ie," Í≥µÍ≥†: "+y(u.applicant.jobpostingTitle),1)):A("",!0)])):(g(),f("div",de,[a("div",null,[e[16]||(e[16]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," ÏßÄÏõê ID * ",-1)),c(a("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>t.value.applyId=s),type:"number",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"ÏßÄÏõê ID",required:""},null,512),[[v,t.value.applyId,void 0,{number:!0}]])]),a("div",null,[e[17]||(e[17]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Í≥µÍ≥† ID * ",-1)),c(a("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>t.value.jobpostingId=s),type:"number",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Í≥µÍ≥† ID",required:""},null,512),[[v,t.value.jobpostingId,void 0,{number:!0}]])]),a("div",null,[e[18]||(e[18]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," ÏßÄÏõêÏûê ID * ",-1)),c(a("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>t.value.userId=s),type:"number",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"ÏßÄÏõêÏûê ID",required:"",onChange:T},null,544),[[v,t.value.userId,void 0,{number:!0}]])])])),a("div",null,[e[19]||(e[19]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," ÏùºÏ†ï Ïú†Ìòï * ",-1)),c(a("select",{"onUpdate:modelValue":e[5]||(e[5]=s=>t.value.type=s),onChange:S,class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"},[(g(),f(F,null,B(D,s=>a("option",{key:s,value:s},y(P(W)[s]),9,ce)),64))],544),[[M,t.value.type]])]),a("div",null,[e[20]||(e[20]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Ï†úÎ™© * ",-1)),c(a("input",{"onUpdate:modelValue":e[6]||(e[6]=s=>t.value.title=s),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"ÏùºÏ†ï Ï†úÎ™©",required:""},null,512),[[v,t.value.title]])]),a("div",pe,[a("div",null,[e[21]||(e[21]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," ÏãúÏûë ÏãúÍ∞Ñ * ",-1)),c(a("input",{"onUpdate:modelValue":e[7]||(e[7]=s=>t.value.startTime=s),type:"datetime-local",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:"",onChange:w},null,544),[[v,t.value.startTime]])]),a("div",null,[e[22]||(e[22]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Ï¢ÖÎ£å ÏãúÍ∞Ñ * ",-1)),c(a("input",{"onUpdate:modelValue":e[8]||(e[8]=s=>t.value.endTime=s),type:"datetime-local",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:"",onChange:w},null,544),[[v,t.value.endTime]])])]),a("div",null,[e[23]||(e[23]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Ïû•ÏÜå ",-1)),c(a("input",{"onUpdate:modelValue":e[9]||(e[9]=s=>t.value.location=s),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Ïû•ÏÜå ÎòêÎäî ÌôîÏÉÅÌöåÏùò ÎßÅÌÅ¨"},null,512),[[v,t.value.location]])]),a("div",ve,[a("div",null,[e[24]||(e[24]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Î©¥Ï†ëÍ¥Ä ID ",-1)),c(a("input",{"onUpdate:modelValue":e[10]||(e[10]=s=>t.value.interviewerId=s),type:"number",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Î©¥Ï†ëÍ¥Ä ID",onChange:T},null,544),[[v,t.value.interviewerId,void 0,{number:!0}]])]),a("div",null,[e[25]||(e[25]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Î©¥Ï†ëÍ¥Ä Ïù¥Î¶Ñ ",-1)),c(a("input",{"onUpdate:modelValue":e[11]||(e[11]=s=>t.value.interviewerName=s),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Î©¥Ï†ëÍ¥Ä Ïù¥Î¶Ñ"},null,512),[[v,t.value.interviewerName]])])]),a("div",null,[e[26]||(e[26]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," ÏïàÎÇ¥ÏÇ¨Ìï≠ ",-1)),c(a("textarea",{"onUpdate:modelValue":e[12]||(e[12]=s=>t.value.description=s),rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent resize-none",placeholder:"ÏßÄÏõêÏûêÏóêÍ≤å Ï†ÑÎã¨Ìï† ÏïàÎÇ¥ÏÇ¨Ìï≠"},null,512),[[v,t.value.description]])]),a("div",me,[a("button",{type:"button",onClick:e[13]||(e[13]=s=>n("close")),class:"px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors"}," Ï∑®ÏÜå "),a("button",{type:"submit",disabled:!x.value||m.value,class:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},y(m.value?"Îì±Î°ù Ï§ë...":"ÏùºÏ†ï Îì±Î°ù"),9,fe)])],32)])])}}});export{Ee as S,Te as _,W as a,Ie as b,be as c,ee as u};
