import{d as E,u as U,E as I,r as m,o as F,k as L,q as f,G as N,c as i,b as t,g as c,t as d,p as x,h as R,i as j,e as _,j as y,B as T,F as G,s as K,v as V,n as $,a as P,l as u}from"./index-BwYT7rAB.js";import{u as z}from"./jobposting-D1MJNH41.js";import{D as O}from"./jobposting-De_onVHJ.js";import{j as Q}from"./jobposting-DwROo58C.js";import{_ as q}from"./SkillTagInput.vue_vue_type_script_setup_true_lang-CmBbyTxJ.js";const W={class:"min-h-screen bg-gray-50"},H={class:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},X={class:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden"},Y={class:"px-6 py-5 border-b border-gray-200"},Z={class:"text-2xl font-bold text-gray-900"},ee={class:"mt-1 text-sm text-gray-500"},te={key:0,class:"px-6 py-12 flex justify-center"},oe={key:0},le=["value"],re={class:"mt-1 text-sm text-gray-500"},se={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-4"},ae={class:"text-red-600 text-sm"},ne={class:"flex justify-end space-x-3 pt-4"},ie=["disabled"],me=E({__name:"JobpostingFormView",setup(de){const S=["Java","Spring Boot","Python","JavaScript","TypeScript","React","Vue.js","Node.js","Go","Kotlin","MySQL","PostgreSQL","MongoDB","Redis","Kafka","Docker","Kubernetes","AWS","GCP","Jenkins"],n=L(),g=P(),v=z(),B=U(),{loading:J,error:k}=I(v),{isAuthenticated:M,isCompany:ue,userId:A}=I(B),r=f(()=>g.name==="JobpostingEdit"),a=f(()=>r.value?g.params.id:null),C=m(O.filter(l=>l.boardId!==1)),e=m({boardId:2,title:"",content:"",requiredSkills:[],preferredSkills:[]}),p=m(!1),b=f(()=>r.value?e.value.title.trim().length>=2&&e.value.content.trim().length>0:e.value.boardId!==""&&e.value.title.trim().length>=2&&e.value.content.trim().length>0);function h(){r.value&&a.value?n.push(`/jobpostings/${a.value}`):n.push("/jobpostings")}async function D(){if(!(!b.value||p.value)){p.value=!0,v.clearError();try{if(r.value&&a.value)await v.updateJobposting(a.value,{title:e.value.title.trim(),content:e.value.content.trim(),requiredSkills:e.value.requiredSkills.length>0?e.value.requiredSkills:void 0,preferredSkills:e.value.preferredSkills.length>0?e.value.preferredSkills:void 0}),n.push(`/jobpostings/${a.value}`);else{const l=await v.createJobposting({boardId:e.value.boardId,title:e.value.title.trim(),content:e.value.content.trim(),requiredSkills:e.value.requiredSkills.length>0?e.value.requiredSkills:void 0,preferredSkills:e.value.preferredSkills.length>0?e.value.preferredSkills:void 0});n.push(`/jobpostings/${l.jobpostingId}`)}}catch(l){console.error("Submit failed:",l)}finally{p.value=!1}}}async function w(){if(!(!r.value||!a.value))try{const l=await Q.getById(a.value);if(l.userId!==A.value){alert("본인이 작성한 채용공고만 수정할 수 있습니다."),n.push(`/jobpostings/${a.value}`);return}e.value.boardId=l.boardId,e.value.title=l.title,e.value.content=l.content,e.value.requiredSkills=l.requiredSkills||[],e.value.preferredSkills=l.preferredSkills||[]}catch(l){console.error("Failed to load jobposting:",l),alert("채용공고를 불러오는데 실패했습니다."),n.push("/jobpostings")}}return F(()=>{if(!M.value){n.push("/auth/login");return}r.value&&w()}),N(()=>g.params.id,()=>{r.value&&w()}),(l,o)=>(u(),i("div",W,[t("div",H,[t("button",{onClick:h,class:"mb-6 flex items-center text-gray-600 hover:text-gray-900 transition-colors"},[o[5]||(o[5]=t("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)),c(" "+d(r.value?"상세로 돌아가기":"목록으로"),1)]),t("div",X,[t("div",Y,[t("h1",Z,d(r.value?"채용공고 수정":"채용공고 등록"),1),t("p",ee,d(r.value?"채용공고 내용을 수정하세요":"새로운 채용공고를 등록하세요"),1)]),r.value&&x(J)?(u(),i("div",te,[...o[6]||(o[6]=[t("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"},null,-1)])])):(u(),i("form",{key:1,onSubmit:R(D,["prevent"]),class:"px-6 py-6 space-y-6"},[r.value?j("",!0):(u(),i("div",oe,[o[8]||(o[8]=t("label",{for:"boardId",class:"block text-sm font-medium text-gray-700 mb-2"},[c(" 게시판 "),t("span",{class:"text-red-500"},"*")],-1)),y(t("select",{id:"boardId","onUpdate:modelValue":o[0]||(o[0]=s=>e.value.boardId=s),required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"},[o[7]||(o[7]=t("option",{value:"",disabled:""},"게시판을 선택하세요",-1)),(u(!0),i(G,null,K(C.value,s=>(u(),i("option",{key:s.boardId,value:s.boardId},d(s.name),9,le))),128))],512),[[T,e.value.boardId]])])),t("div",null,[o[9]||(o[9]=t("label",{for:"title",class:"block text-sm font-medium text-gray-700 mb-2"},[c(" 제목 "),t("span",{class:"text-red-500"},"*")],-1)),y(t("input",{id:"title","onUpdate:modelValue":o[1]||(o[1]=s=>e.value.title=s),type:"text",required:"",maxlength:"100",placeholder:"채용공고 제목을 입력하세요",class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"},null,512),[[V,e.value.title]]),t("p",re,d(e.value.title.length)+"/100",1)]),t("div",null,[o[10]||(o[10]=t("label",{for:"content",class:"block text-sm font-medium text-gray-700 mb-2"},[c(" 내용 "),t("span",{class:"text-red-500"},"*")],-1)),y(t("textarea",{id:"content","onUpdate:modelValue":o[2]||(o[2]=s=>e.value.content=s),required:"",rows:"15",placeholder:`채용공고 내용을 입력하세요

예시:
[담당업무]
- 백엔드 API 개발
- 데이터베이스 설계

[자격요건]
- Java/Spring 경험 3년 이상

[우대사항]
- MSA 경험
- Kubernetes 경험`,class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent resize-none"},null,512),[[V,e.value.content]])]),_(q,{modelValue:e.value.requiredSkills,"onUpdate:modelValue":o[3]||(o[3]=s=>e.value.requiredSkills=s),label:"필수 스킬",placeholder:"필수 스킬을 입력하세요","help-text":"자격요건에 해당하는 필수 기술을 입력하세요 (AI 매칭에 활용)",color:"blue",suggestions:S},null,8,["modelValue"]),_(q,{modelValue:e.value.preferredSkills,"onUpdate:modelValue":o[4]||(o[4]=s=>e.value.preferredSkills=s),label:"우대 스킬",placeholder:"우대 스킬을 입력하세요","help-text":"우대사항에 해당하는 기술을 입력하세요",color:"purple",suggestions:S},null,8,["modelValue"]),x(k)?(u(),i("div",se,[t("p",ae,d(x(k)),1)])):j("",!0),t("div",ne,[t("button",{type:"button",onClick:h,class:"px-6 py-3 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors"}," 취소 "),t("button",{type:"submit",disabled:p.value||!b.value,class:$([p.value||!b.value?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-700 text-white","px-6 py-3 text-sm font-medium rounded-lg transition-colors"])},d(p.value?"처리 중...":r.value?"수정하기":"등록하기"),11,ie)])],32))])])]))}});export{me as default};
