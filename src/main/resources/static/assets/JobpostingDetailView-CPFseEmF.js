import{d as G,u as Q,E as B,o as W,a as X,r as b,H as Y,c as n,b as e,i as c,g as p,p as s,t as a,n as h,q as Z,j as ee,v as te,e as oe,w as se,f as re,F as V,s as z,h as ne,k as ie,l as i}from"./index-BwYT7rAB.js";import{u as ae}from"./jobposting-D1MJNH41.js";import{u as le}from"./apply-D6qdncHI.js";import{_ as de}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./jobposting-DwROo58C.js";import"./apply-BYj9I28m.js";const ue={class:"min-h-screen bg-gray-50"},ce={class:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},pe={key:0,class:"flex justify-center items-center py-20"},ge={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-6"},ve={class:"text-red-600"},me={key:2,class:"space-y-6"},be={class:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden"},ye={class:"px-6 py-5 border-b border-gray-200"},xe={class:"text-2xl font-bold text-gray-900"},fe={class:"mt-3 flex flex-wrap items-center text-sm text-gray-500 gap-4"},he={key:0},_e={class:"px-6 py-6"},ke={class:"prose max-w-none whitespace-pre-wrap"},we={class:"px-6 py-4 bg-gray-50 border-t border-gray-200"},Ce={class:"flex items-center justify-between"},je={class:"flex items-center space-x-6 text-sm text-gray-500"},Ie={class:"flex items-center"},Me={class:"flex items-center"},Ae={class:"flex items-center space-x-3"},Le=["fill"],De={key:1,class:"flex items-center text-gray-400"},Be=["disabled"],Ve={key:0,class:"px-6 py-4 border-t border-gray-200 flex justify-end space-x-3"},ze={class:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden"},Je={class:"px-6 py-4 border-b border-gray-200"},Se={class:"text-lg font-semibold text-gray-900"},Te={key:0,class:"px-6 py-4 border-b border-gray-200"},$e={class:"mt-3 flex justify-end"},Ne=["disabled"],Re={key:1,class:"px-6 py-4 border-b border-gray-200 bg-gray-50"},Ee={class:"text-gray-500 text-center"},Fe={class:"divide-y divide-gray-200"},He={key:0,class:"px-6 py-8 text-center text-gray-500"},Pe={class:"flex justify-between items-start"},Ue={class:"flex-1"},qe={class:"flex items-center space-x-2"},Ke={class:"font-medium text-gray-900"},Oe={class:"text-sm text-gray-500"},Ge={class:"mt-2 text-gray-700 whitespace-pre-wrap"},Qe=["onClick"],We={key:2,class:"px-6 py-4 border-t border-gray-200 flex justify-center"},Xe={class:"flex items-center space-x-2"},Ye=["onClick"],Ze={class:"bg-white rounded-lg p-6 max-w-md w-full mx-4"},et={class:"flex justify-end space-x-3"},tt=["disabled"],ot=G({__name:"JobpostingDetailView",setup(st){const k=ie(),I=X(),d=ae(),J=Q(),w=le(),{currentJobposting:o,comments:M,loading:S,error:A,commentPage:T,commentTotalPages:L}=B(d),{isAuthenticated:g,userId:u}=B(J),v=b(""),y=b(!1),x=b(!1),_=b(!1),f=b(!1),m=b(!1),D=Z(()=>{var r;return g.value&&((r=o.value)==null?void 0:r.userId)===u.value});function $(){k.push("/jobpostings")}function N(){o.value&&k.push(`/jobpostings/${o.value.jobpostingId}/edit`)}function R(){x.value=!0}async function E(){if(o.value){_.value=!0;try{await d.deleteJobposting(o.value.jobpostingId),k.push("/jobpostings")}catch{alert("삭제에 실패했습니다.")}finally{_.value=!1,x.value=!1}}}async function F(){if(!(!g.value||!o.value||!u.value))try{await d.toggleLike(o.value.jobpostingId)}catch{alert("좋아요 처리에 실패했습니다.")}}async function H(){var r;if(!(!g.value||!o.value||!u.value)&&!(f.value||m.value)){f.value=!0;try{await w.createApply({userId:u.value,jobpostingId:o.value.jobpostingId}),m.value=!0,alert("지원이 완료되었습니다!")}catch(t){(r=t.message)!=null&&r.includes("이미 지원")?(m.value=!0,alert("이미 지원한 공고입니다.")):alert("지원에 실패했습니다.")}finally{f.value=!1}}}async function P(){if(!(!v.value.trim()||!o.value)){y.value=!0;try{await d.createComment({jobpostingId:o.value.jobpostingId,content:v.value.trim()}),v.value=""}catch{alert("댓글 작성에 실패했습니다.")}finally{y.value=!1}}}async function U(r){if(confirm("댓글을 삭제하시겠습니까?")&&o.value)try{await d.deleteComment(r,o.value.jobpostingId)}catch{alert("댓글 삭제에 실패했습니다.")}}function q(r){o.value&&d.fetchComments(o.value.jobpostingId,r-1)}function K(){const r=I.params.id;d.fetchJobposting(r,u.value||void 0)}function C(r){return new Date(r).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}return W(async()=>{const r=I.params.id;try{if(await d.fetchJobposting(r,u.value||void 0),await d.fetchComments(r,0),g.value&&u.value)try{await w.fetchMyApplies(u.value);const t=w.myApplies;m.value=t.some(j=>j.jobpostingId===r)}catch{}}catch(t){console.error("Failed to load jobposting:",t)}}),Y(()=>{d.clearCurrentJobposting()}),(r,t)=>{const j=re("router-link");return i(),n("div",ue,[e("div",ce,[e("button",{onClick:$,class:"mb-6 flex items-center text-gray-600 hover:text-gray-900 transition-colors"},[...t[3]||(t[3]=[e("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),p(" 목록으로 ",-1)])]),s(S)?(i(),n("div",pe,[...t[4]||(t[4]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"},null,-1)])])):s(A)?(i(),n("div",ge,[e("p",ve,a(s(A)),1),e("button",{onClick:K,class:"mt-2 text-sm text-red-700 underline"},"다시 시도")])):s(o)?(i(),n("div",me,[e("div",be,[e("div",ye,[e("h1",xe,a(s(o).title),1),e("div",fe,[e("span",null,"작성자 ID: "+a(s(o).userId),1),t[5]||(t[5]=e("span",null,"•",-1)),e("span",null,a(C(s(o).createdAt)),1),s(o).updatedAt!==s(o).createdAt?(i(),n("span",he," • 수정됨: "+a(C(s(o).updatedAt)),1)):c("",!0)])]),e("div",_e,[e("div",ke,a(s(o).content),1)]),e("div",we,[e("div",Ce,[e("div",je,[e("div",Ie,[t[6]||(t[6]=e("svg",{class:"w-5 h-5 mr-1.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1)),p(" 조회 "+a(s(o).viewCount),1)]),e("div",Me,[t[7]||(t[7]=e("svg",{class:"w-5 h-5 mr-1.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})],-1)),p(" 댓글 "+a(s(o).commentCount),1)])]),e("div",Ae,[s(g)?(i(),n("button",{key:0,onClick:F,class:h([s(o).isLiked?"bg-red-100 text-red-600 border-red-200":"bg-white text-gray-600 border-gray-300 hover:bg-gray-50","flex items-center px-4 py-2 rounded-lg border transition-colors"])},[(i(),n("svg",{class:h([[s(o).isLiked?"text-red-500":"text-gray-400"],"w-5 h-5 mr-1.5"]),fill:s(o).isLiked?"currentColor":"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...t[8]||(t[8]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"},null,-1)])],10,Le)),p(" 좋아요 "+a(s(o).likeCount),1)],2)):(i(),n("div",De,[t[9]||(t[9]=e("svg",{class:"w-5 h-5 mr-1.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})],-1)),p(" 좋아요 "+a(s(o).likeCount),1)])),s(g)&&!D.value?(i(),n("button",{key:2,onClick:H,disabled:f.value||m.value,class:h([m.value?"bg-gray-100 text-gray-500 border-gray-200 cursor-not-allowed":"bg-indigo-600 text-white border-indigo-600 hover:bg-indigo-700","flex items-center px-4 py-2 rounded-lg border transition-colors"])},[t[10]||(t[10]=e("svg",{class:"w-5 h-5 mr-1.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),p(" "+a(f.value?"지원 중...":m.value?"지원 완료":"지원하기"),1)],10,Be)):c("",!0)])])]),D.value?(i(),n("div",Ve,[e("button",{onClick:N,class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition-colors"}," 수정 "),e("button",{onClick:R,class:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 transition-colors"}," 삭제 ")])):c("",!0)]),e("div",ze,[e("div",Je,[e("h2",Se," 댓글 "+a(s(o).commentCount)+"개 ",1)]),s(g)?(i(),n("div",Te,[ee(e("textarea",{"onUpdate:modelValue":t[0]||(t[0]=l=>v.value=l),rows:"3",placeholder:"댓글을 작성하세요...",class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent resize-none"},null,512),[[te,v.value]]),e("div",$e,[e("button",{onClick:P,disabled:!v.value.trim()||y.value,class:h([v.value.trim()&&!y.value?"bg-indigo-600 hover:bg-indigo-700 text-white":"bg-gray-300 text-gray-500 cursor-not-allowed","px-4 py-2 rounded-md text-sm font-medium transition-colors"])},a(y.value?"등록 중...":"댓글 등록"),11,Ne)])])):(i(),n("div",Re,[e("p",Ee,[oe(j,{to:"/auth/login",class:"text-indigo-600 hover:underline"},{default:se(()=>[...t[11]||(t[11]=[p("로그인",-1)])]),_:1}),t[12]||(t[12]=p(" 하시면 댓글을 작성할 수 있습니다. ",-1))])])),e("div",Fe,[s(M).length===0?(i(),n("div",He," 아직 댓글이 없습니다. 첫 번째 댓글을 작성해보세요! ")):c("",!0),(i(!0),n(V,null,z(s(M),l=>(i(),n("div",{key:l.commentId,class:"px-6 py-4"},[e("div",Pe,[e("div",Ue,[e("div",qe,[e("span",Ke,"사용자 "+a(l.userId),1),e("span",Oe,a(C(l.createdAt)),1)]),e("p",Ge,a(l.content),1)]),l.userId===s(u)?(i(),n("button",{key:0,onClick:O=>U(l.commentId),class:"text-gray-400 hover:text-red-500 transition-colors"},[...t[13]||(t[13]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,Qe)):c("",!0)])]))),128))]),s(L)>1?(i(),n("div",We,[e("nav",Xe,[(i(!0),n(V,null,z(s(L),l=>(i(),n("button",{key:l,onClick:O=>q(l),class:h([l-1===s(T)?"bg-indigo-600 text-white":"text-gray-700 hover:bg-gray-100","px-3 py-1 rounded text-sm"])},a(l),11,Ye))),128))])])):c("",!0)])])):c("",!0),x.value?(i(),n("div",{key:3,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:t[2]||(t[2]=ne(l=>x.value=!1,["self"]))},[e("div",Ze,[t[14]||(t[14]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"채용공고 삭제",-1)),t[15]||(t[15]=e("p",{class:"text-gray-600 mb-6"},"정말로 이 채용공고를 삭제하시겠습니까? 이 작업은 되돌릴 수 없습니다.",-1)),e("div",et,[e("button",{onClick:t[1]||(t[1]=l=>x.value=!1),class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50"}," 취소 "),e("button",{onClick:E,disabled:_.value,class:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 disabled:opacity-50"},a(_.value?"삭제 중...":"삭제"),9,tt)])])])):c("",!0)])])}}}),ut=de(ot,[["__scopeId","data-v-af23e417"]]);export{ut as default};
